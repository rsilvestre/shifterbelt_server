{"version":3,"sources":["bootstrap.es6"],"names":[],"mappings":";;;;;;;;;;;;;;;;wBAImB,aAAa;;;;+BACX,sBAAsB;;;;2BACpB,kBAAkB;;kBAC1B,IAAI;;;;qBACD,OAAO;;;;AAEzB,SAAS,UAAU,CAAC,IAAI,EAAE;AACxB,SAAO,6BAAS,IAAI,CAAC,CAAC;CACvB;;AAED,SAAS,QAAQ,CAAC,GAAG,EAAE;AACrB,MAAI,IAAI,GAAG,sBAAO,QAAQ,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;AAC3C,SAAO,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM,EAAK;AACtC,QAAI,6BAAS,IAAI,CAAC,CAAC,OAAO,CAAC,CAAC;GAC7B,CAAC,CAAC;CACJ;;IAEoB,SAAS;AACjB,WADQ,SAAS,CAChB,QAAQ,EAAE;0BADH,SAAS;;;AAG1B,uBAAM,IAAI,CAAC,gBAAG,WAAW,MAAI,sBAAO,IAAI,aAAU,EAAE,UAAS,IAAI,EAAE,QAAQ,EAAE;AAC3E,UAAI,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;AACtB,eAAO,MAAI,sBAAO,IAAI,gBAAW,IAAI,CAAG,CAAC;OAC1C;AACD,cAAQ,EAAE,CAAA;KACX,EAAC,UAAC,GAAG,EAAK;AACT,UAAI,GAAG,EAAE;AACP,qBAzBC,MAAM,CAyBA,IAAI,CAAC,GAAG,CAAC,CAAC;OAClB;KACF,CAAC,CAAC;GACJ;;eAbkB,SAAS;;WAezB,eAAG;AACJ,UAAI,GAAG,GAAG,OAAO,MAAI,sBAAO,IAAI,aAAU,CAAC;AAC3C,UAAI,CAAC,GAAG,QAAQ,CAAC,UAAU,CAAC,CACzB,IAAI,CAAC,YAAK;AACT,qBAlCC,MAAM,CAkCA,IAAI,CAAC,iBAAiB,CAAC,CAAC;AAC/B,eAAO,QAAQ,CAAC,QAAQ,CAAC,CAAC;OAC3B,CAAC,CACD,IAAI,CAAC,YAAM;AACV,qBAtCC,MAAM,CAsCA,IAAI,CAAC,eAAe,CAAC,CAAC;AAC7B,eAAO,QAAQ,CAAC,OAAO,CAAC,CAAC;OAC1B,CAAC,CACD,IAAI,CAAC,YAAM;AACV,qBA1CC,MAAM,CA0CA,IAAI,CAAC,cAAc,CAAC,CAAC;AAC5B,eAAO,QAAQ,CAAC,WAAW,CAAC,CAAC;OAC9B,CAAC,CACD,IAAI,CAAC,YAAM;AACV,qBA9CC,MAAM,CA8CA,IAAI,CAAC,kBAAkB,CAAC,CAAC;;AAEhC,YAAI,GAAG,GAAG,IAAI,GAAG,EAAE,CAAC;OAErB,CAAC,CAAC;KACN;;;SApCkB,SAAS;;;qBAAT,SAAS","file":"bootstrap.js","sourcesContent":["/**\n * Created by michaelsilvestre on 19/04/15\n */\n\nimport config from \"./config.js\"\nimport adapters from \"../adapters/index.js\"\nimport { logger } from \"../lib/logger.js\"\nimport fs from 'fs'\nimport async from 'async'\n\nfunction getAdapter(name) {\n  return adapters[name];\n}\n\nfunction dbloader(key) {\n  let name = config.adapters.getAdapter(key);\n  return new Promise((resolve, reject) => {\n    new adapters[name](resolve);\n  });\n}\n\nexport default class Bootstrap {\n  constructor(callback) {\n    // Bootstrap models\n    async.each(fs.readdirSync(`${config.root}/models`), function(file, callback) {\n      if (/\\.js$/.test(file)) {\n        require(`${config.root}/models/${file}`);\n      }\n      callback()\n    },(err) => {\n      if (err) {\n        logger.warn(err);\n      }\n    });\n  }\n\n  run() {\n    let App = require(`${config.root}/app.js`);\n    var p = dbloader(\"database\")\n      .then(()=> {\n        logger.info('database loaded');\n        return dbloader(\"memory\");\n      })\n      .then(() => {\n        logger.info('memory loaded');\n        return dbloader(\"queue\");\n      })\n      .then(() => {\n        logger.info('queue loaded');\n        return dbloader(\"websocket\");\n      })\n      .then(() => {\n        logger.info('websocket loaded');\n\n        let app = new App();\n\n      });\n  }\n}\n"]}