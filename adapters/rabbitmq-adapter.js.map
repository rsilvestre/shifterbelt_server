{"version":3,"sources":["/Users/michaelsilvestre/git/shifterbelt/beta/adapters/rabbitmq-adapter.es6"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;sBAImB,WAAW;;;;sBACN,uBAAuB;;IAAnC,MAAM;;2BACK,iBAAiB;;;;IAEnB,aAAa;AACnB,aADM,aAAa,CAClB,QAAQ,EAAE;8BADL,aAAa;;AAE1B,mCAFa,aAAa,6CAEpB,OAAO,EAAE;AACf,YAAI,CAAC,IAAI,GAAG,IAAI,CAAC;AACjB,YAAI,CAAC,IAAI,GAAG,IAAI,CAAC;;AAEjB,YAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;KACvB;;cAPgB,aAAa;;iBAAb,aAAa;;eAS1B,cAAC,QAAQ,EAAE;;;AACX,gBAAI,YAAY,GAAG,MAAM,CAAC,QAAQ,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;;AAEtD,gBAAI,CAAC,QAAQ,GAAG,OAAO,CAAC,WAAW,CAAC,CAAC,aAAa,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC;AACrE,gBAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,OAAO,EAAE,YAAM;AAC5B,4BAAY,CAAC;;AAEb,uBAAO,CAAC,GAAG,CAAC,8BAA8B,CAAC,CAAC;AAC5C,sBAAK,IAAI,GAAG,MAAK,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;AACxC,sBAAK,IAAI,GAAG,MAAK,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;;AAExC,sBAAK,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;AAC9B,sBAAK,IAAI,CAAC,EAAE,CAAC,MAAM,EAAE,UAAC,IAAI,EAAK;AAC3B,gCAAY,CAAC;;AAEb,2BAAO,CAAC,GAAG,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;AAChC,uBAAG,CAAC,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;iBAChC,CAAC,CAAC;;AAEH,sBAAK,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,YAAM;AAC9B,gCAAY,CAAC;;AAEb,0BAAK,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;iBAC/B,CAAC,CAAC;AACH,wBAAQ,OAAM,CAAC;aAClB,CAAC,CAAC;SAEN;;;aAES,YAAG;AACT,mBAAO,IAAI,CAAC,QAAQ,CAAC;SACxB;;;WAxCgB,aAAa;;;qBAAb,aAAa","file":"rabbitmq-adapter.js","sourcesContent":["/**\n * Created by michaelsilvestre on 19/04/15\n */\n\nimport rabbit from \"rabbit.js\"\nimport * as config from \"../config/adapters.js\"\nimport AbsAdapter from \"./absAdapter.js\"\n\nexport default class RabbitAdapter extends AbsAdapter {\n    constructor(callback) {\n        super(\"queue\");\n        this._pub = null;\n        this._sub = null;\n\n        this.init(callback);\n    }\n\n    init(callback) {\n        let rabbitConfig = config.adapters.getConfig(\"queue\");\n\n        this._context = require('rabbit.js').createContext(rabbitConfig.url);\n        this._context.on('ready', () => {\n            \"use strict\";\n\n            console.log('rabbit successfull connected');\n            this._pub = this._context.socket('PUB');\n            this._sub = this._context.socket('SUB');\n            //sub.pipe(process.stdout);\n            this._sub.setEncoding('utf8');\n            this._sub.on('data', (note) => {\n                \"use strict\";\n\n                console.log(\"Alarum! %s\", note);\n                log.info(\"Alarum! %s\", note);\n            });\n\n            this._sub.connect('events', () => {\n                \"use strict\";\n\n                this._pub.connect('events');\n            });\n            callback(this);\n        });\n\n    }\n\n    get rabbit() {\n        return this._context;\n    }\n\n}"]}