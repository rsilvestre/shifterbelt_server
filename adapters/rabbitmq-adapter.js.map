{"version":3,"sources":["rabbitmq-adapter.es6"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;wBAImB,WAAW;;;;8BACN,qBAAqB;;IAAjC,MAAM;;4BACK,iBAAiB;;;;2BACjB,kBAAkB;;IAEpB,aAAa;AACrB,WADQ,aAAa,CACpB,QAAQ,EAAE;0BADH,aAAa;;AAE9B,+BAFiB,aAAa,6CAExB,OAAO,EAAE;AACf,QAAI,CAAC,IAAI,GAAG,IAAI,CAAC;AACjB,QAAI,CAAC,IAAI,GAAG,IAAI,CAAC;;AAEjB,QAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;GACrB;;YAPkB,aAAa;;eAAb,aAAa;;WAS5B,cAAC,QAAQ,EAAE;;;AACb,UAAI,YAAY,GAAG,MAAM,CAAC,QAAQ,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;;AAEtD,UAAI,CAAC,QAAQ,GAAG,OAAO,CAAC,WAAW,CAAC,CAAC,aAAa,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC;AACrE,UAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,OAAO,EAAE,YAAM;AAC9B,oBAAY,CAAC;;AAEb,eAAO,CAAC,GAAG,CAAC,8BAA8B,CAAC,CAAC;AAC5C,qBAnBG,MAAM,CAmBF,IAAI,CAAC,8BAA8B,CAAC,CAAC;AAC5C,cAAK,IAAI,GAAG,MAAK,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;AACxC,cAAK,IAAI,GAAG,MAAK,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;;AAExC,cAAK,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;AAC9B,cAAK,IAAI,CAAC,EAAE,CAAC,MAAM,EAAE,UAAC,IAAI,EAAK;AAC7B,sBAAY,CAAC;;AAEb,iBAAO,CAAC,GAAG,eAAa,IAAI,CAAG,CAAC;AAChC,uBA5BC,MAAM,CA4BA,IAAI,eAAa,IAAI,CAAG,CAAC;SACjC,CAAC,CAAC;;AAEH,cAAK,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,YAAM;AAChC,sBAAY,CAAC;;AAEb,gBAAK,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;SAC7B,CAAC,CAAC;AACH,gBAAQ,OAAM,CAAC;OAChB,CAAC,CAAC;KAEJ;;;SAES,YAAG;AACX,aAAO,IAAI,CAAC,QAAQ,CAAC;KACtB;;;SAzCkB,aAAa;;;qBAAb,aAAa","file":"rabbitmq-adapter.js","sourcesContent":["/**\n * Created by michaelsilvestre on 19/04/15\n */\n\nimport rabbit from \"rabbit.js\"\nimport * as config from \"../config/config.js\"\nimport AbsAdapter from \"./absAdapter.js\"\nimport { logger } from \"../lib/logger.js\"\n\nexport default class RabbitAdapter extends AbsAdapter {\n  constructor(callback) {\n    super(\"queue\");\n    this._pub = null;\n    this._sub = null;\n\n    this.init(callback);\n  }\n\n  init(callback) {\n    let rabbitConfig = config.adapters.getConfig(\"queue\");\n\n    this._context = require('rabbit.js').createContext(rabbitConfig.url);\n    this._context.on('ready', () => {\n      \"use strict\";\n\n      console.log('rabbit successfull connected');\n      logger.info('rabbit successfull connected');\n      this._pub = this._context.socket('PUB');\n      this._sub = this._context.socket('SUB');\n      //sub.pipe(process.stdout);\n      this._sub.setEncoding('utf8');\n      this._sub.on('data', (note) => {\n        \"use strict\";\n\n        console.log(`Alarum! '${note}`);\n        logger.info(`Alarum! '${note}`);\n      });\n\n      this._sub.connect('events', () => {\n        \"use strict\";\n\n        this._pub.connect('events');\n      });\n      callback(this);\n    });\n\n  }\n\n  get rabbit() {\n    return this._context;\n  }\n\n}"]}